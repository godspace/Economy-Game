<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#2196F3">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–≠–≤–æ–ª—é—Ü–∏—è –¥–æ–≤–µ—Ä–∏—è</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ù</text></svg>">
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    <div id="auth-screen" class="screen active">
        <div class="auth-container">
            <h1>ü§ù –≠–≤–æ–ª—é—Ü–∏—è –¥–æ–≤–µ—Ä–∏—è</h1>
            <p>–í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –∏–∑ CSV —Ñ–∞–π–ª–∞</p>
            <input type="text" id="code-input" maxlength="6" placeholder="000000" autocomplete="off">
            <button id="login-btn">–í–æ–π—Ç–∏</button>
            <div class="error-message" id="login-error"></div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Å–∫—Ä—ã—Ç –¥–æ –≤—Ö–æ–¥–∞) -->
    <div id="app-screen" class="screen">
        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∏–≥—Ä–æ–∫–µ -->
        <header class="app-header">
            <div class="player-info">
                <div class="player-avatar" id="player-avatar"></div>
                <div class="player-details">
                    <div class="player-name" id="player-name">–ò–≥—Ä–æ–∫</div>
                    <div class="player-coins">
                        <span class="material-icons">monetization_on</span>
                        <span id="coins-count">100</span>
                    </div>
                </div>
            </div>
            <button id="logout-btn" class="icon-btn">
                <span class="material-icons">logout</span>
            </button>
        </header>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="players">
                <span class="material-icons">people</span>
                <span>–ò–≥—Ä–æ–∫–∏</span>
            </button>
            <button class="tab-btn" data-tab="deals">
                <span class="material-icons">handshake</span>
                <span>–°–¥–µ–ª–∫–∏</span>
            </button>
            <button class="tab-btn" data-tab="rating">
                <span class="material-icons">leaderboard</span>
                <span>–†–µ–π—Ç–∏–Ω–≥</span>
            </button>
            <button class="tab-btn" data-tab="shop">
                <span class="material-icons">store</span>
                <span>–ú–∞–≥–∞–∑–∏–Ω</span>
            </button>
            <!-- –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
            <button class="tab-btn admin-only" data-tab="orders" style="display: none;">
                <span class="material-icons">list_alt</span>
                <span>–ó–∞–∫–∞–∑—ã</span>
            </button>
        </nav>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤–∫–ª–∞–¥–æ–∫ -->
        <main class="tab-content">
            <div id="players-tab" class="tab-pane active">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ –ò–≥—Ä–æ–∫–∏ -->
            </div>
            <div id="deals-tab" class="tab-pane">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ –°–¥–µ–ª–∫–∏ -->
            </div>
            <div id="rating-tab" class="tab-pane">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ –†–µ–π—Ç–∏–Ω–≥ -->
            </div>
            <div id="shop-tab" class="tab-pane">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ –ú–∞–≥–∞–∑–∏–Ω -->
            </div>
            <div id="orders-tab" class="tab-pane">
                <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏ –ó–∞–∫–∞–∑—ã (–∞–¥–º–∏–Ω) -->
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–¥–µ–ª–∫–∏ -->
    <div id="deal-modal" class="modal">
        <div class="modal-content">
            <h2 id="deal-title">–°–¥–µ–ª–∫–∞ —Å <span class="deal-player-name"></span></h2>
            <div class="deal-choices">
                <button class="choice-btn" data-choice="cooperate">
                    <span class="material-icons">handshake</span>
                    –°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å (+2/+2)
                </button>
                <button class="choice-btn" data-choice="cheat">
                    <span class="material-icons">warning</span>
                    –ñ—É–ª—å–Ω–∏—á–∞—Ç—å (+3/-1)
                </button>
            </div>
            <div class="deal-info">
                <p>–û—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–æ–∫ —Å —ç—Ç–∏–º –∏–≥—Ä–æ–∫–æ–º: <span id="deals-left">5</span></p>
            </div>
            <button id="cancel-deal" class="secondary-btn">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="toast" class="toast"></div>

    <!-- –ó–∞–≥—Ä—É–∑—á–∏–∫ -->
    <div id="loader" class="loader">
        <div class="spinner"></div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Supabase –∏ –Ω–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script src="js/deals.js"></script>
    <script src="js/rating.js"></script>
    <script src="js/shop.js"></script>
    <script src="js/admin.js"></script>
    <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
    document.addEventListener('DOMContentLoaded', async () => {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        if (authManager.currentUser) {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
            if (!window.dealsManager) {
                // –ó–∞–≥—Ä—É–∑–∏–º –º–æ–¥—É–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
                await Promise.all([
                    import('./js/deals.js'),
                    import('./js/rating.js'),
                    import('./js/shop.js'),
                    import('./js/admin.js')
                ]);
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∏—Å–∫
            appManager.initSearch();
        }
    });
    </script>
    <!-- –û–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–π —Å–¥–µ–ª–∫–µ -->
    <div id="new-deal-notification" class="new-deal-notification">
        <span class="material-icons">notifications</span>
        <span id="notification-text">–ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞!</span>
    </div>    
</body>
</html>